# RFACL

## Pytorch implementation of Receptive Field Aware Contrastive Learning for Multivariate Time Series Classification

### Requirements
You will need the following to run the above:
Pytorch 1.13.0, Torchvision 0.14.0, Python 3.6.8, Pillow 5.4.1 and Numpy 1.22.4

### Dataset
You can get the UEA dataset [here](http://timeseriesclassification.com/dataset.php "访问数据集")
For running the experiments on these datasets, you need to first run preprocess/data_read_UEA.py to pre-process the dataset. After that, run main.py

### Results
| Datasets | Metrics | BYOL | GTN | TS-TCC | Disjoint | TS2Vec | MF-Net | TodyNet | Time-MIL | FCSTGNN | TS-GAC | Ours |
|----------|---------|------|-----|--------|----------|--------|--------|---------|----------|---------|--------|------|
| AWR      | Acc     | 93.67| 87.17| 95.08  | 98.33    | 98.67  | 93.02  | 94.76   | 91.25    | 93.00   | 98.43  | 99.03 |
|          | MF1     | 93.68| 85.50| 94.28  | 97.92    | 98.70  | 92.66  | 94.40   | 90.95    | 93.01   | 98.33  | 98.96 |
| EC       | Acc     | 29.28| 27.51| 20.31  | 25.85    | 31.17  | 25.34  | 29.46   | 28.39    | 33.46   | 33.57  | 36.04 |
|          | MF1     | 28.55| 26.82| 19.96  | 29.89    | 31.28  | 17.29  | 28.74   | 19.36    | 27.54   | 30.80  | 34.85 |
| EW       | Acc     | 60.31| 49.12| 57.58  | 41.98    | 80.15  | 45.83  | 42.92   | 35.32    | 59.54   | 65.25  | 71.62 |
|          | MF1     | 39.86| 43.08| 51.29  | 20.96    | 74.93  | 37.43  | 42.39   | 27.18    | 44.97   | 63.02  | 52.85 |
| FD       | Acc     | 53.32| 65.10| 63.63  | 52.52    | 51.42  | 64.25  | 64.21   | 50.03    | 66.06   | 65.08  | 66.56 |
|          | MF1     | 53.30| 65.00| 63.36  | 53.13    | 50.81  | 63.79  | 64.19   | 33.57    | 66.00   | 65.02  | 66.10 |
| FM       | Acc     | 45.00| 55.10| 45.00  | 56.00    | 50.00  | 52.33  | 52.49   | 54.52    | 53.00   | 50.00  | 60.71 |
|          | MF1     | 44.99| 55.45| 42.26  | 50.99    | 49.97  | 48.45  | 52.27   | 52.33    | 52.76   | 45.61  | 58.91 |
| HMD      | Acc     | 39.19| 45.10| 36.49  | 27.03    | 37.83  | 32.79  | 36.67   | 29.89    | 35.14   | 25.31  | 49.68 |
|          | MF1     | 32.06| 40.39| 35.33  | 34.72    | 35.64  | 30.46  | 32.84   | 27.02    | 34.92   | 34.90  | 41.57 |
| PEMS     | Acc     | 69.36| 58.38| 70.71  | 73.41    | 67.63  | 81.70  | 72.24   | 39.84    | 77.45   | 81.14  | 82.01 |
|          | MF1     | 57.95| 53.00| 69.43  | 70.17    | 67.63  | 80.42  | 71.33   | 33.72    | 76.51   | 81.08  | 81.52 |
| PS       | Acc     | 19.65| 19.45| 21.56  | 25.02    | 22.72  | 19.93  | 26.79   | 22.36    | 16.61   | 21.71  | 27.49 |
|          | MF1     | 17.86| 17.36| 20.31  | 20.84    | 22.39  | 18.25  | 25.34   | 21.65    | 15.92   | 21.29  | 26.97 |
| RS       | Acc     | 81.58| 77.63| 86.20  | 86.84    | 81.57  | 77.63  | 80.49   | 82.25    | 82.87   | 76.73  | 87.75 |
|          | MF1     | 83.13| 79.60| 79.92  | 83.49    | 82.66  | 78.41  | 81.56   | 82.66    | 83.63   | 74.70  | 84.93 |
| SRS1     | Acc     | 81.91| 81.31| 81.71  | 82.94    | 76.11  | 76.54  | 83.83   | 75.18    | 82.01   | 80.53  | 84.77 |
|          | MF1     | 81.53| 80.45| 81.45  | 81.97    | 75.10  | 75.38  | 83.80   | 74.06    | 81.44   | 80.54  | 84.19 |
